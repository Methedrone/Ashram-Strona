---
import { getLangFromUrl, useTranslations } from '../i18n/utils';

interface Props {
  activePath?: string;
}

const { activePath } = Astro.props;
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const navItems = [
  { href: `/${lang}/`, text: t('nav.home') },
  { href: `/${lang}/about`, text: t('nav.about') },
  { href: `/${lang}/teachings`, text: t('nav.teachings') },
  { href: `/${lang}/events`, text: t('nav.events') },
  { href: `/${lang}/gallery`, text: t('nav.gallery') },
  { href: `/${lang}/contact`, text: t('nav.contact') },
  { href: `/${lang}/donations`, text: t('nav.donations') },
];

// Language switcher logic
const currentPath = activePath || Astro.url.pathname;
let switchPath = '';
if (lang === 'pl') {
    switchPath = currentPath.replace(/^\/pl/, '/en');
} else {
    switchPath = currentPath.replace(/^\/en/, '/pl');
}

const switchText = lang === 'pl' ? 'English' : 'Polski';
---

<header>
    <nav>
        <ul>
            {navItems.map(item => (
                <li><a href={item.href} class={currentPath === item.href ? 'active' : ''}>{item.text}</a></li>
            ))}
            <li><a href={switchPath} class="lang-switch">{switchText}</a></li>
        </ul>
    </nav>
</header>

<style>
    header {
        background: var(--color-header-bg, #fff);
        padding: 1rem 2rem;
        border-bottom: 3px solid var(--color-gold, #FFD700);
    }
    nav ul {
        display: flex;
        gap: 1.5rem;
        list-style: none;
        padding: 0;
        margin: 0;
        flex-wrap: wrap;
        align-items: center;
    }
    nav a {
        text-decoration: none;
        color: var(--color-text, #333);
        font-weight: 500;
        transition: color 0.2s;
    }
    nav a:hover, nav a.active {
        color: var(--color-orange, #FF6B00);
        text-decoration: none;
    }
    .lang-switch {
        font-weight: bold;
        margin-left: auto;
        color: var(--color-orange, #FF6B00) !important;
        border: 1px solid var(--color-orange, #FF6B00);
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
    }
    .lang-switch:hover {
        background-color: var(--color-orange, #FF6B00);
        color: white !important;
    }
</style>
